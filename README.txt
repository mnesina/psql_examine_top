Пример анализа загрузки postgresql - получение тяжелых, перегружающих систему запросов:
- берем по крону то, что превышает некое нами определенное значение загрузки 
и отправляем это на анализ, собираемый статистикой посгреса (она, естественно, должна быть включена)
(/usr/bin/top -d1 -ocpu -Upgsql |/usr/bin/grep pgsql) | /usr/local/bin/php 
/путь/psql_query/test_top.php ну, или сразу: /путь/psql_query/test_top.sh